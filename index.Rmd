---
title: "La percepción de corrupción a nivel global - Años 2019 y 2020"
subtitle: 'Curso: POL304 - Estadística para el análisis político 2'
author: "Santiago Maldonado Vizcarra, Andrea Salas y Ana Goñi"
date: "Noviembre, 2022"
output:
 prettydoc::html_pretty:
  theme: cayman
  highlight: github
---
 

```{r include=FALSE}
library(rio)
library(dplyr)
library(ggplot2)
library(cowplot)
library(kableExtra)
library(equatiomatic)
library(tables)
library(rmarkdown)
library(reshape)
library(DT)
library(modelsummary)
library(factoextra)
library(cluster)
```


El objetivo del presente trabajo es analizar los resultados de la percepción de corrupción a nivel global en los años 2019 y 2020. Escogimos este periodo temporal por el cambio drástico que generó la propagación del virus COVID-19 en el desarrollo económico, político y social. En ese sentido, intentamos determinar si la pandemia realmente tuvo un impacto significativo en la percepción ciudadana.  


# 1. Datos previos al análisis:


+ La variable dependiente escogida para este estudio es la "Percepción de corrupción" (PERCOR). 
+ Se ha eliminado la variable independiente "Saneamiento", esto debido a que la base de datos ofrecia muy pocos casos para el análisis. 


# 2. Base de datos unificada:


```{r include=FALSE}
LinkBDU = "https://github.com/santiagomv29/PRACTICAS_ESTA2/raw/main/dataunificada.csv"
library(rio)
BDU = import(LinkBDU)
```

```{r echo=FALSE}
datatable(BDU, filter = "top")
```

# 3. Mapas de calor con variable dependiente: 


```{r include=FALSE}
library(sp)
library(rgdal)
library(ggplot2)
mapDIS=sf::read_sf("fwdshapefile/world-administrative-boundaries.shp")

```

```{r include=FALSE}
MAP = merge(mapDIS,BDU, by.x = "iso3", by.y = "ISO", all.x = T)
```


## 3.1. Mapa de calor 2019:

```{r echo=FALSE}

mapaleyendaL= ggplot(MAP)+ geom_sf() + theme_light()

mapaleyL= mapaleyendaL + geom_sf(data=MAP,
              aes(fill=`2019PERCOR`),color = NA)
      
mapa3= mapaleyL +
coord_sf() + 
scale_fill_gradient(low = "seashell",  high = "firebrick", breaks=seq(from=0, to=1, by=.2)) + theme_void() + 
  
theme(axis.title = element_blank(), axis.text = element_blank(), legend.position = c(1.1,0.55)) + labs(fill=" ") + theme(legend.text = element_text(size = 13)) +
  
labs(title = "Percepción de corrupción - 2019", subtitle = "") +
  
theme(
plot.title = element_text(color="black", size=15, face="bold"),
plot.caption = element_text(color = "black", size=10))

mapa3
```


## 3.2. Mapa de calor 2020:

```{r echo=FALSE}

mapaleyendaL2= ggplot(MAP)+ geom_sf() + theme_light()

mapaleyL2= mapaleyendaL2 + geom_sf(data=MAP,
              aes(fill=`2020PERCOR`),color = NA)
      
mapa4= mapaleyL2 +
coord_sf() + 
scale_fill_gradient(low = "seashell",  high = "firebrick", breaks=seq(from=0, to=1, by=.2)) + theme_void() + 
  
theme(axis.title = element_blank(), axis.text = element_blank(), legend.position = c(1.1,0.55)) + labs(fill=" ") + theme(legend.text = element_text(size = 13)) +
  
labs(title = "Percepción de corrupción - 2020", subtitle = "") +
  
theme(
plot.title = element_text(color="black", size=15, face="bold"),
plot.caption = element_text(color = "black", size=10))

mapa4
```


# 4. Regresión con variables independientes "Independencia de justicia", "Gobierno electo" y "Ausencia de corrupción":


## 4.1. Año 2019:


## 4.1.1. Modelo Lineal:

```{r include=FALSE}
REGREVA19LM = lm(BDU$`2019PERCOR` ~ BDU$`2019INDEP` + BDU$`2019ELECT` + BDU$`2019AUSCORR`) 
summary(REGREVA19LM) 
```

```{r echo=FALSE}
equatiomatic::extract_eq(REGREVA19LM, use_coefs = TRUE)
```

```{r echo=FALSE}
model=list('2019PERCOR'=BDU)
modelsummary(REGREVA19LM, title = "Modelo lineal",
             stars = TRUE,
             output = "kableExtra")
```

## 4.1.2. Modelo Poisson: 

```{r include=FALSE}
REGREVA19 = glm(BDU$`2019PERCOR` ~ BDU$`2019INDEP` + BDU$`2019ELECT` + BDU$`2019AUSCORR`,family = poisson(link = "log")) 
summary(REGREVA19)
```

```{r echo=FALSE}
equatiomatic::extract_eq(REGREVA19, use_coefs = TRUE)
```

```{r echo=FALSE}
model=list('2019PERCOR'=BDU)
modelsummary(REGREVA19, title = "Poisson",
             stars = TRUE,
             output = "kableExtra")
```

## 4.1.2.1. Coeficientes exponenciados: 

```{r echo=FALSE}
INDEPENDENCIA19=coef(REGREVA19)[['BDU$`2019INDEP`']] 
V_INJUS19=exp(INDEPENDENCIA19) 
(CambioINDEPENDENCIA19=100*(V_INJUS19)) 
```

```{r echo=FALSE}
ELECTO19=coef(REGREVA19)[['BDU$`2019ELECT`']] 
V_ELECT19=exp(ELECTO19) 
(CambioELECTO19=100*(1-1/V_ELECT19))
```

```{r echo=FALSE}
AUSENCIA19=coef(REGREVA19)[['BDU$`2019AUSCORR`']] 
V_AUSCORR19=exp(AUSENCIA19) 
(CambioAUSENCIA19=100*(V_AUSCORR19))
```


## 4.2. Año 2020:

## 4.2.1. Modelo Lineal:

```{r include=FALSE}
REGREVA20LM = lm(BDU$`2020PERCOR` ~ BDU$`2020INDEP` + BDU$`2020ELECT` + BDU$`2020AUSCORR`) 
summary(REGREVA19LM) 
```

```{r echo=FALSE}
equatiomatic::extract_eq(REGREVA20LM, use_coefs = TRUE)
```

```{r echo=FALSE}
model=list('2020PERCOR'=BDU)
modelsummary(REGREVA20LM, title = "Modelo Lineal",
             stars = TRUE,
             output = "kableExtra")
```

## 4.2.2. Modelo Poisson:

```{r include=FALSE}
REGREVA20 = glm(BDU$`2020PERCOR` ~ BDU$`2020INDEP` + BDU$`2020ELECT` + BDU$`2020AUSCORR`,family = poisson(link = "log"))
summary(REGREVA20)
```

```{r echo=FALSE}
equatiomatic::extract_eq(REGREVA20, use_coefs = TRUE)
```

```{r echo=FALSE}
model=list('2020PERCOR'=BDU)
modelsummary(REGREVA20, title = "Poisson",
             stars = TRUE,
             output = "kableExtra")
```

```{r echo=FALSE}
INDEPENDENCIA20=coef(REGREVA20)[['BDU$`2020INDEP`']] 
V_INJUS20=exp(INDEPENDENCIA20) 
(CambioINDEPENDENCIA20=100*(V_INJUS20)) 
```

```{r echo=FALSE}
ELECTO20=coef(REGREVA20)[['BDU$`2020ELECT`']] 
V_ELECT20=exp(ELECTO20) 
(CambioELECTO20=100*(1-1/V_ELECT20))
```

```{r echo=FALSE}
AUSENCIA20=coef(REGREVA20)[['BDU$`2020AUSCORR`']] 
V_AUSCORR20=exp(AUSENCIA20) 
(CambioAUSENCIA20=100*(V_AUSCORR20))
```


## 4.3. Análisis de resultados:


En el modelo del 2019, la percepción de la corrupción va a aumentar en un 115% al aumentar la independencia de justicia. También aumentará en 582% al aumentar el indice de ausencia de corrupción. Además, disminuirá en un 17.1% en respuesta a las composición decisiones y acciones del gobierno electo. 

Para el modelo del año 2020, la percepción de la corrupción va a aumentar en un 110% al aumentar la independencia de justicia. También aumentará en 593% al aumentar el indice de ausencia de corrupción. Además, disminuirá en un 14.3% en respuesta a las composición decisiones y acciones del gobierno electo. 

En los modelos de los años 2019 y 2020, los predictores de independencia de justicia y gobierno electo son poco significativos. En consecuencia, no se puede decir que estas variables impacten en la percepción de la corrupción, esto a pesar de que la variable gobierno electo gana cierto grado de significancia en 2020. Por otro lado, la predictora ausencia de corrupción no solo es significativa, sino que incrementa su valor de 2019 a 2020. Es interesante ver como la "ausencia de corrupción" esta generando un incremento en la "percepción de corrupción". Esto nos lleva a pensar que las mediciones no fueron hechas de manera adecuada (o se escogieron mal los parametros. 


# 5. Regresión con variables independientes "Desempleo" e "Inflación"


## 5.1. Año 2019

## 5.1.1. Modelo Lineal:

```{r include=FALSE}
REGREVS19LM = lm(BDU$`2019PERCOR` ~ BDU$`2019DES` + BDU$`2019INFLACION`)
summary(REGREVS19LM)
```

```{r echo=FALSE}
equatiomatic::extract_eq(REGREVS19LM, use_coefs = TRUE)
```

```{r echo=FALSE}
model=list('2019PERCOR'=BDU)
modelsummary(REGREVS19LM, title = "Modelo Lineal", 
             stars = TRUE,
             output = "kableExtra")
```

## 5.1.2. Modelo Poisson:

```{r include=FALSE}
REGREVS19 = glm(BDU$`2019PERCOR` ~ BDU$`2019DES` + BDU$`2019INFLACION`,family = poisson(link = "log"))
summary(REGREVS19)
```

```{r echo=FALSE}
equatiomatic::extract_eq(REGREVS19, use_coefs = TRUE)
```

```{r echo=FALSE}
model=list('2019PERCOR'=BDU)
modelsummary(REGREVS19, title = "Poisson", 
             stars = TRUE,
             output = "kableExtra")
```

## 5.1.2.1. Coeficientes exponenciados: 

```{r echo=FALSE}
DESEMPLEO19=coef(REGREVS19)[['BDU$`2019DES`']] 
V_DES19=exp(DESEMPLEO19) 
(CambioDESEMPLEO19=100*(1-1/V_DES19)) 
```

```{r echo=FALSE}
INFLACION19=coef(REGREVS19)[['BDU$`2019INFLACION`']] 
V_INFLA19=exp(INFLACION19) 
(CambioINFLACION19=100*(1-1/V_INFLA19))
```


## 5.2. Año 2020

## 5.2.1. Modelo Lineal:

```{r include=FALSE}
REGREVS20LM = lm(BDU$`2020PERCOR` ~ BDU$`2020DES` + BDU$`2020INFLACION`)
summary(REGREVS19LM)
```

```{r echo=FALSE}
equatiomatic::extract_eq(REGREVS20LM, use_coefs = TRUE)
```

```{r echo=FALSE}
model=list('2020PERCOR'=BDU)
modelsummary(REGREVS20LM, title = "Modelo Lineal", 
             stars = TRUE,
             output = "kableExtra")
```

## 5.2.2. Modelo Poisson:

```{r include=FALSE}
REGREVS20 = glm(BDU$`2020PERCOR` ~ BDU$`2020DES` + BDU$`2020INFLACION`, family = poisson(link = "log"))
summary(REGREVS20)
```

```{r echo=FALSE}
equatiomatic::extract_eq(REGREVS20, use_coefs = TRUE)
```

```{r echo=FALSE}
model=list('2020PERCOR'=BDU)
modelsummary(REGREVS20, title = "Poisson", 
             stars = TRUE,
             output = "kableExtra")
```

## 5.2.2.1. Coeficientes exponenciados: 

```{r echo=FALSE}
DESEMPLEO20=coef(REGREVS20)[['BDU$`2020DES`']] 
V_DES20=exp(DESEMPLEO20) 
(CambioDESEMPLEO20=100*(1-1/V_DES20)) 
```

```{r echo=FALSE}
INFLACION20=coef(REGREVS20)[['BDU$`2020INFLACION`']] 
V_INFLA20=exp(INFLACION20) 
(CambioINFLACION19=100*(1-1/V_INFLA20))

```


## 5.3 Análisis de resultados:


Para el modelo del 2019, la percepción de la corrupción va a disminuir en un 0.76% a medida que aumenta el desempleo y, siguiendo esa tendencia, disminuirá en un 0.63% al aumentar en un punto la inflación.

Para el modelo del año 2020, la percepción de la corrupción va a disminuir en un 0.67% en respuesta al aumento del desempleo. Asi mismo, disminuirá en 0.25% cuando la inflación aumente en un punto. 

En los modelos de los años 2019 y 2020, tanto el predictor de desempleo como el de inflación registran estimates significativos (visibilizado en los asteriscos). En ese sentido, es claro que ambas variables impactan sobre la percepción de la corrupción. Sin embargo, los resultados de 2020 son incluso más bajos que los de 2019. Esto implica que la emergencia sanitaria provocada por la propagación del COVID-19 no tuvo un efecto tan fuerte en estos problemas socioeconómicos como se tiende a pensar. Por ello, el impacto sobre la variable dependiente es relativamente débil. 


# 6. Regresión con variables independientes "Indice de democracia", "IDH" y "Legitimidad estatal":


## 6.1. Año 2019:

## 6.1.1. Modelo Lineal:

```{r include=FALSE}
REGREVANA19LM = lm(BDU$`2019PERCOR` ~ BDU$`2019PAR` + BDU$`2019IDH` + BDU$`2019LEG`)
summary(REGREVANA19LM)
```

```{r echo=FALSE}
equatiomatic::extract_eq(REGREVANA19LM, use_coefs = TRUE)
```

```{r echo=FALSE}
model=list('2019PERCOR'=BDU)
modelsummary(REGREVANA19LM, title = "Modelo Lineal", 
             stars = TRUE,
             output = "kableExtra")
```

## 6.1.2. Modelo Poisson: 

```{r include=FALSE}
REGREVANA19 = glm(BDU$`2019PERCOR` ~ BDU$`2019PAR` + BDU$`2019IDH` + BDU$`2019LEG`,family = poisson(link = "log"))
summary(REGREVANA19)
```

```{r echo=FALSE}
equatiomatic::extract_eq(REGREVANA19, use_coefs = TRUE)
```

```{r echo=FALSE}
model=list('2019PERCOR'=BDU)
modelsummary(REGREVANA19, title = "Poisson", 
             stars = TRUE,
             output = "kableExtra")
```

## 6.1.2.1. Coeficientes exponenciados: 

```{r echo=FALSE}
DEMOCRACIA19=coef(REGREVANA19)[['BDU$`2019PAR`']] 
V_DEM19=exp(DEMOCRACIA19) 
(CambioDEMOCRACIA19=100*(1-1/V_DEM19)) 
```

```{r echo=FALSE}
IDH19=coef(REGREVANA19)[['BDU$`2019IDH`']] 
V_IDH19=exp(IDH19) 
(CambioIDH19=100*(V_IDH19))
```

```{r echo=FALSE}
LEGITIMIDAD19=coef(REGREVANA19)[['BDU$`2019LEG`']] 
V_LEG19=exp(LEGITIMIDAD19) 
(CambioLEGITIMIDAD20=100*(1-1/V_LEG19))
```


## 6.2. Año 2020:

## 6.2.1. Modelo Lineal:

```{r include=FALSE}
REGREVANA20LM = lm(BDU$`2020PERCOR` ~ BDU$`2020PAR` + BDU$`2020IDH` + BDU$`2020LEG`)
summary(REGREVANA19)
```

```{r echo=FALSE}
equatiomatic::extract_eq(REGREVANA20LM, use_coefs = TRUE)
```

```{r echo=FALSE}
model=list('2020PERCOR'=BDU)
modelsummary(REGREVANA20LM, title = "Modelo Lineal", 
             stars = TRUE,
             output = "kableExtra")
```

## 6.2.2. Modelo Poisson: 

```{r include=FALSE}
REGREVANA20 = glm(BDU$`2020PERCOR` ~ BDU$`2020PAR` + BDU$`2020IDH` + BDU$`2020LEG`,family = poisson(link = "log"))
summary(REGREVANA20)
```

```{r echo=FALSE}
equatiomatic::extract_eq(REGREVANA20, use_coefs = TRUE)
```

```{r echo=FALSE}
model=list('PERCOR.y.x'=BDU)
modelsummary(REGREVANA20, title = "Poisson",
             stars = TRUE,
             output = "kableExtra")
```

## 6.2.2.1. Coeficientes exponenciados: 

```{r echo=FALSE}
DEMOCRACIA20=coef(REGREVANA20)[['BDU$`2020PAR`']] 
V_DEM20=exp(DEMOCRACIA20) 
(CambioDEMOCRACIA20=100*(1-1/V_DEM20)) 
```

```{r echo=FALSE}
IDH20=coef(REGREVANA20)[['BDU$`2020IDH`']] 
V_IDH20=exp(IDH20) 
(CambioIDH20=100*(V_IDH20))
```

```{r echo=FALSE}
LEGITIMIDAD20=coef(REGREVANA20)[['BDU$`2020LEG`']] 
V_LEG20=exp(LEGITIMIDAD20) 
(CambioLEGITIMIDAD20=100*(1-1/V_LEG20))
```


## 6.3. Análisis de los resultados: 


Para el modelo del 2019, la percepción de la corrupción va a disminuir en un 26.8% al aumentar el índice  de democracia, además, va a aumentar en un 321% al aumentar en un punto el IDH y va a disminuir en un 9.8% cuando la legitimidad estatal aumenta.

Para el modelo del año 2020, la percepción de la corrupción va a disminuir en un 10.6% frente al aumento del índice de democracia, asimismo, va a aumentar en un 369% al aumentar en un punto el IDH y va a disminuir en un 7.7% cuando la legitimidad estatal aumenta.

En los modelos de los años 2019 y 2020, los predictores de legitimidad estatal e IDH se muestran muy significativos; es decir, estas variables causan gran impacto en la percepción de la corrupción. Sin embargo, se evidencia que la variable de índice de democracia pierde significancia entre estos mismos años, por lo que no resulta muy significativa. Ello indica que el indice de democracia, respecto a paises en los que hay elecciones y competitividad política, no impacta realmente en la percepción de la corrupción de los ciudadanos.
