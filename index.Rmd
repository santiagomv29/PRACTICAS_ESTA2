---
title: "La percepción de corrupción a nivel global entre 2019 y 2020"
subtitle: 'Curso: POL304 - Estadística para el análisis político 2'
author: "Santiago Maldonado Vizcarra, Andrea Salas y Ana Goñi"
date: "Noviembre, 2022"
output: html_document
---

```{r include=FALSE}
library(rio)
library(dplyr)
library(ggplot2)
library(cowplot)
library(knitr)
library(kableExtra)
library(reshape)
library(DT)
library(equatiomatic)
library(modelsummary)
library(factoextra)
library(cluster)
```


El objetivo del presente trabajo es analizar los resultados de la percepción de corrupción a nivel global en los años 2019 y 2020. Escogimos este periodo temporal por el cambio drástico que generó la propagación del virus COVID-19 en el desarrollo económico, político y social. En ese sentido, intentamos determinar si la pandemia realmente tuvo un impacto significativo en la percepción ciudadana.  


# 1. Datos previos al análisis 

+ La variable dependiente escogida para este estudio es la "Percepción de corrupción" (PERCOR). 
+ Se ha eliminado la variable independiente "Saneamiento", esto debido a que la base de datos ofrecia muy pocos casos para el análisis. 


# 2. Base de datos unificada

```{r echo=FALSE}
LinkBDU = "https://github.com/santiagomv29/PRACTICAS_ESTA2/raw/main/base_dataunificada.csv"
library(rio)
BDU = import(LinkBDU)
library(magrittr)
BDU%>%
rmarkdown::paged_table()
```


# 3. Regresión con variables independientes "Independencia de justicia", "Gobierno electo" y "Ausencia de corrupción"

## 3.1. Año 2019

```{r include=FALSE}
REGREVA19 = glm(BDU$PERCOR_2019.y.x ~ BDU$`2019INDEP` + BDU$`2019ELECT` + BDU$`2019AUSCORR`,family = poisson(link = "log"))
summary(REGREVA19)
```

```{r echo=FALSE}
equatiomatic::extract_eq(REGREVA19, use_coefs = TRUE)
```

```{r echo=FALSE}
model=list('PERCOR.y.x'=BDU)
modelsummary(REGREVA19, title = "Poisson",
             stars = TRUE,
             output = "kableExtra")
```

## 3.2. Año 2020

```{r include=FALSE}
REGREVA20 = glm(BDU$PERCOR_2020.y.x ~ BDU$`2020INDEP` + BDU$`2020ELECT` + BDU$`2020AUSCORR`,family = poisson(link = "log"))
summary(REGREVA20)
```

```{r echo=FALSE}
equatiomatic::extract_eq(REGREVA20, use_coefs = TRUE)
```

```{r echo=FALSE}
model=list('PERCOR.y.x'=BDU)
modelsummary(REGREVA20, title = "Poisson",
             stars = TRUE,
             output = "kableExtra")
```


# 4. Regresión con variables independientes "Desempleo" e "Inflación"

## 4.1. Año 2019

```{r include=FALSE}
REGREVS19 = glm(BDU$PERCOR_2019.y.x ~ BDU$DES2019 + BDU$INFLACION_2019,family = poisson(link = "log"))
summary(REGREVS19)#CORREGIR
```

```{r echo=FALSE}
equatiomatic::extract_eq(REGREVS19, use_coefs = TRUE)
```

```{r echo=FALSE}
model=list('PERCOR.y.x'=BDU)
modelsummary(REGREVS19, title = "Poisson",
             stars = TRUE,
             output = "kableExtra")
```

## 4.2. Año 2020

```{r include=FALSE}
REGREVS20 = glm(BDU$PERCOR_2020.y.x ~ BDU$DES2020 + BDU$INFLACION_2020,family = poisson(link = "log"))
summary(REGREVS20)
```

```{r echo=FALSE}
equatiomatic::extract_eq(REGREVS20, use_coefs = TRUE)
```

```{r echo=FALSE}
model=list('PERCOR.y.x'=BDU)
modelsummary(REGREVS20, title = "Poisson", stars = TRUE,
             output = "kableExtra")
```

# 5. Regresión con variables independientes "Percepción de la democracia", "IDH" y "Legitimidad estatal"

## 5.1. Año 2019

```{r include=FALSE}
REGREVANA19 = glm(BDU$PERCOR_2019.y.x ~ BDU$`2019PAR` + BDU$`2019IDH` + BDU$`2019LEG`,family = poisson(link = "log"))
summary(REGREVANA19)
```

```{r echo=FALSE}
equatiomatic::extract_eq(REGREVANA19, use_coefs = TRUE)
```

```{r echo=FALSE}
model=list('PERCOR.y.x'=BDU)
modelsummary(REGREVANA19, title = "Poisson",
             stars = TRUE,
             output = "kableExtra")
```

## 5.2. Año 2020

```{r include=FALSE}
REGREVANA20 = glm(BDU$PERCOR_2020.y.x ~ BDU$`2020PAR` + BDU$`2020IDH` + BDU$`2020LEG`,family = poisson(link = "log"))
summary(REGREVANA20)
```

```{r echo=FALSE}
equatiomatic::extract_eq(REGREVANA20, use_coefs = TRUE)
```

```{r echo=FALSE}
model=list('PERCOR.y.x'=BDU)
modelsummary(REGREVANA20, title = "Poisson",
             stars = TRUE,
             output = "kableExtra")
```


